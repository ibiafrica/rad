<script src="<?= BASE_ASSET; ?>/js/jquery.hotkeys.js"></script>

<script type="text/javascript">
    //This page is a result of an autogenerated content made by running test.html with firefox.
    function domo() {

        // Binding keys
        $('*').bind('keydown', 'Ctrl+a', function assets() {
            window.location.href = BASE_URL + '/administrator/inventaires/add';
            return false;
        });

        $('*').bind('keydown', 'Ctrl+f', function assets() {
            $('#sbtn').trigger('click');
            return false;
        });

        $('*').bind('keydown', 'Ctrl+x', function assets() {
            $('#reset').trigger('click');
            return false;
        });

        $('*').bind('keydown', 'Ctrl+b', function assets() {

            $('#reset').trigger('click');
            return false;
        });
    }

    jQuery(document).ready(domo);
</script>
<!-- Content Header (Page header) -->
<section class="content-header">
    <h1> <?= $boutique['NAME_STORE']; ?> <i class="fa fa-chevron-right"></i> Liste des inventaires<small></small></h1>
    <ol class="breadcrumb">
        <li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
        <li class="active">Inventaires</li>
    </ol>
</section>
<!-- Main content -->
<section class="content">
    <div class="row">

        <div class="col-md-12">
            <div class="box box-warning">
                <div class="box-body ">
                    <hr>

                    <!-- <button type="button" onclick="printPage()" class="print" style="background: pink">
                    IMPRIMER !
                </button> -->
                    <button type="button" print-item=".content-wrapper" name="name" class="btn btn-default" onclick="printPage()">Imprimer
                        <!-- <i class="fa fa-print"></i> -->
                    </button>
                    <div class="panel-heading">
                        <h3 class="panel-title"><strong>Inventaire: &nbsp;&nbsp;</strong></h3>
                    </div>
                    <div class="table-responsive">
                        <table class="table table-condensed">
                            <thead>
                                <tr>
                                    <td><strong>Produit</strong></td>
                                    <td class="text-center"><strong>Qte Theorique</strong></td>
                                    <td class="text-center"><strong>Qte Physique</strong></td>
                                    <td class="text-center"><strong>Difference</strong></td>
                                </tr>
                            </thead>
                            <tbody>

                                <?php foreach ($inventaires_items->result() as $items) : ?>
                                    <tr>
                                        <?php $product_name = $this->model_rm->getOne('pos_store_' . $this->uri->segment(2) . '_ibi_articles', array('CODEBAR_ARTICLE' => $items->BARCODE_IVI)) ?>
                                        <td><?= $product_name['DESIGN_ARTICLE'] ?></td>
                                        <td class="text-center"><?php
                                                                echo strrev(wordwrap(strrev($items->QUANTITY_THEORIQUE_IVI), 3, ' ', true)); ?>
                                        </td>
                                        <td class="text-center"><?php
                                                                echo strrev(wordwrap(strrev($items->QUANTITY_PHYSIQUE_IVI), 3, ' ', true)); ?>
                                        </td>
                                        <td class="text-center"><?php
                                                                echo strrev(wordwrap(strrev($items->DIFF), 3, ' ', true)); ?>
                                        </td>
                                    </tr>
                                <?php endforeach; ?>
                                <?php foreach ($inventaires_sum->result() as $inventaires_sum) : ?>
                                    <tr>
                                        <td colspan="1" style="padding-bottom :5px;">Total</td>
                                        <td class="text-center"><?php
                                                                echo strrev(wordwrap(strrev($inventaires_sum->QUANTITY_THEORIQUE_IVI), 3, ' ', true)); ?>
                                        </td>
                                        <td class="text-center"><?php
                                                                echo strrev(wordwrap(strrev($inventaires_sum->QUANTITY_PHYSIQUE_IVI), 3, ' ', true)); ?></td>
                                        <td class="text-center"> <?php
                                                                    echo strrev(wordwrap(strrev($inventaires_sum->DIFF), 3, ' ', true)); ?>
                                        </td>
                                    </tr>
                                <?php endforeach; ?>
                                <tr style="height: 30px"></tr>
                                <tr>
                                    <td colspan="5" style="font-size: 15px">
                                        <p>Fait Par &nbsp;&nbsp;&nbsp;:&nbsp;<?= $author['username']; ?> </p>
                                        <p>Signature</p>
                                    </td>
                                </tr>

                            </tbody>

                        </table>
                    </div>


                    <div class="row">

                    </div>

                </div>
                <!--/box body -->
            </div>
            <!--/box -->
        </div>
    </div>
</section>
<!-- /.content -->

<!-- Page script -->
<style>
    @media print {
        .print {
            display: none;
        }
    }

    .print {
        border-radius: 4px;
        cursor: hand;
    }

    .main-footer {
        display: none;
    }
</style>
<script>
    function printPage() {
        window.print();
    }
</script>

<script>
    $(document).ready(function() {

        $('.remove-data').click(function() {

            var url = $(this).attr('data-href');

            swal({
                    title: "<?= cclang('are_you_sure'); ?>",
                    text: "<?= cclang('data_to_be_deleted_can_not_be_restored'); ?>",
                    type: "input",
                    showCancelButton: true,
                    confirmButtonColor: "#DD6B55",
                    confirmButtonText: "<?= cclang('yes_delete_it'); ?>",
                    cancelButtonText: "<?= cclang('no_cancel_plx'); ?>",
                    closeOnConfirm: true,
                    closeOnCancel: true,
                    animation: "slide-from-top",
                    inputPlaceholder: "Donnez un commentaire S.V.P."
                },
                function(inputValue) {
                    if (inputValue === false) {
                        return false;
                    }
                    if (inputValue === "") {
                        swal.showInputError("Vous devriez ecrire un commentaire SVP.!!!");
                        return false;
                    }
                    document.location.href = url + '?inputValue=' + inputValue;
                },
                function(isConfirm) {
                    // if (isConfirm) {
                    //    document.location.href = BASE_URL + '/administrator/pos_store_1_ibi_inventaires/delete?' + serialize_bulk;      
                    // }
                });

            return false;
        });


        $('#apply').click(function() {

            var bulk = $('#bulk');
            var serialize_bulk = $('#form_pos_store_1_ibi_inventaires').serialize();

            if (bulk.val() == 'delete') {
                swal({
                        title: "<?= cclang('are_you_sure'); ?>",
                        text: "<?= cclang('data_to_be_deleted_can_not_be_restored'); ?>",
                        type: "input",
                        showCancelButton: true,
                        confirmButtonColor: "#DD6B55",
                        confirmButtonText: "<?= cclang('yes_delete_it'); ?>",
                        cancelButtonText: "<?= cclang('no_cancel_plx'); ?>",
                        closeOnConfirm: true,
                        closeOnCancel: true,
                        animation: "slide-from-top",
                        inputPlaceholder: "Donnez un commentaire S.V.P."
                    },
                    function(inputValue) {
                        if (inputValue === false) {
                            return false;
                        }
                        if (inputValue === "") {
                            swal.showInputError("Vous devriez ecrire un commentaire SVP.!!!");
                            return false;
                        }
                        document.location.href = url + '?inputValue=' + inputValue;
                    },
                    function(isConfirm) {
                        // if (isConfirm) {
                        //    document.location.href = BASE_URL + '/administrator/pos_store_1_ibi_inventaires/delete?' + serialize_bulk;      
                        // }
                    });

                return false;

            } else if (bulk.val() == '') {
                swal({
                    title: "Upss",
                    text: "<?= cclang('please_choose_bulk_action_first'); ?>",
                    type: "warning",
                    showCancelButton: false,
                    confirmButtonColor: "#DD6B55",
                    confirmButtonText: "Okay!",
                    closeOnConfirm: true,
                    closeOnCancel: true
                });

                return false;
            }

            return false;

        }); /*end appliy click*/


        //check all
        var checkAll = $('#check_all');
        var checkboxes = $('input.check');

        checkAll.on('ifChecked ifUnchecked', function(event) {
            if (event.type == 'ifChecked') {
                checkboxes.iCheck('check');
            } else {
                checkboxes.iCheck('uncheck');
            }
        });

        checkboxes.on('ifChanged', function(event) {
            if (checkboxes.filter(':checked').length == checkboxes.length) {
                checkAll.prop('checked', 'checked');
            } else {
                checkAll.removeProp('checked');
            }
            checkAll.iCheck('update');
        });

    }); /*end doc ready*/
</script>
<!-- nturubika rothshild david -->