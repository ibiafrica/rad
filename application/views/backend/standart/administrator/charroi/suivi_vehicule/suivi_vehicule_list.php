<script src="<?= BASE_ASSET; ?>/js/jquery.hotkeys.js"></script>

<script type="text/javascript">
//This page is a result of an autogenerated content made by running test.html with firefox.
function domo(){
 
   // Binding keys
   $('*').bind('keydown', 'Ctrl+a', function assets() {
       window.location.href = BASE_URL + '/administrator/suivi_vehicule/add/<?php $this->uri->segment(4) ?>';
       return false;
   });

   $('*').bind('keydown', 'Ctrl+f', function assets() {

       $('#sbtn').trigger('click');
       return false;
   });

   $('*').bind('keydown', 'Ctrl+x', function assets() {
       $('#reset').trigger('click');
       return false;
   });

   $('*').bind('keydown', 'Ctrl+b', function assets() {

       $('#reset').trigger('click');
       return false;
   });
}

jQuery(document).ready(domo);
</script>
<style type="text/css">
  tr:hover td{
    background-color: #ccc !important;
  }
</style>
<!-- Content Header (Page header) -->
<section class="content-header">
   <h1>
      Suivi des véhicules<small></small>
   </h1>
   <h5 class="widget-user-desc"><i class="label bg-yellow"></i></h5>
   <ol class="breadcrumb">
      <li><a href="#"><i class="fa fa-dashboard"></i> Accueil</a></li>
      <li class="active">Suivi</li>
   </ol>
</section>
<!-- Main content -->
<section class="content">
   <div class="row" >
      
      <div class="col-md-12">
         <div class="box box-warning">
            <div class="box-body ">
               <!-- Widget: user widget style 1 -->
               <div class="box box-widget widget-user-2">
                  <!-- Add the bg color to the header using any of the bg-* classes -->
                  <form name="form_power" id="form_fiche_travail" action="<?= base_url('administrator/suivi_vehicule/index/'.$this->uri->segment(4)); ?>">
                        <div class="widget-user-header ">
                         <div class="row pull-center" style="margin-left:5%">
                          <div  class="col-md-8">
                             <div class="col-sm-4 padd-left-0  " >
                                <input type="text" class="form-control" name="q" id="filter" placeholder="<?= cclang('filter'); ?>" value="<?= $this->input->get('q'); ?>">
                             </div>
                             <div class="col-sm-3 padd-left-0 " >
                                <select type="text" class="form-control chosen chosen-select" name="f" id="field" >
                                   <option value=""><?= cclang('all'); ?></option>
                                    <option <?= $this->input->get('f') == 'DATE_SUIVI' ? 'selected' :''; ?> value="DATE_SUIVI">Date</option>
                                    <option <?= $this->input->get('f') == 'CHAUFFEUR_SUIVI' ? 'selected' : ''; ?> value="CHAUFFEUR_SUIVI">Nom du chauffeur</option>
                                  </select>
                             </div>
                             <div class="col-sm-1 padd-left-0 ">
                                <button type="submit" class="btn btn-flat" name="sbtn" id="sbtn" value="Apply" title="Rechercher">
                                <i class="fa fa-search"></i>
                                </button>
                             </div>
                             <div class="col-sm-1 padd-left-0 ">
                                <a class="btn btn-default btn-flat" name="reset" id="reset" value="Apply" href="<?= base_url('administrator/suivi_vehicule/index/'.$this->uri->segment(4));?>" title="<?= cclang('reset_filter'); ?>">
                                <i class="fa fa-undo"></i>
                                </a>
                             </div>
                          </div>
                            <?php is_allowed('maintenance_add', function(){?>
                            <a class="btn btn-flat btn-success btn_add_new" id="btn_add_new" title="" href="<?=  site_url('administrator/suivi_vehicule/add/'.$this->uri->segment(4)); ?>"><i class="fa fa-plus" ></i></a>
                            <?php }) ?>
                        </div>
                      </div>
                  </form>

                  <div class="table-responsive"> 
                    <table class="table table-bordered table-striped dataTable">
                     <thead>
                        <tr>
                           <th>&#8470; &nbsp;</th>
                           <th>Date</th>
                           <th>Marque & Plaque</th>
                           <th>Chauffeur</th>
                           <th>&#8470; &nbsp; de passagers</th>
                           <th>H. départ</th>
                           <th>Kms départ</th>
                           <th>H. retour</th>
                           <th>Kms retour</th>
                           <th>Kms parcourus</th>
                           <th>Action</th>
                        </tr>
                     </thead>
                     <tbody id="tbody_power">
                     <?php $i = 0;
                     foreach($suivi_vehicules as $suivi_vehicule): 
                      $i++;
                      ?>
                        <tr>
                          <td><?= $i?></td>
                          <td><?= _ent($suivi_vehicule->DATE_SUIVI); ?></td> 
                          <td><?= _ent($suivi_vehicule->MARQUE_VOITURE); ?></td> 
                          <td><?= _ent($suivi_vehicule->CHAUFFEUR_SUIVI); ?></td> 
                          <td><?= _ent($suivi_vehicule->NBRE_PASSAGERS_SUIVI); ?></td> 
                          <td><?= _ent($suivi_vehicule->START_TIME_SUIVI); ?></td> 
                          <td><?= _ent($suivi_vehicule->KMS_DEPART_SUIVI) ?></td>
                          <td><?= _ent($suivi_vehicule->END_TIME_SUIVI) ?></td>
                          <td><?= _ent($suivi_vehicule->KMS_RETOUR_SUIVI) ?></td>
                          <td><?= _ent($suivi_vehicule->KMS_DEPART_SUIVI) - _ent($suivi_vehicule->KMS_RETOUR_SUIVI) ?></td>
                         <td width="150">
                            <?php is_allowed('charroi_update', function() use ($suivi_vehicule){?>
                              <a title="Modification de ce suivi" href="<?= site_url('administrator/suivi_vehicule/edit/'.$this->uri->segment(4).'/' . $suivi_vehicule->ID_SUIVI); ?>" class="btn btn-default btn-xs"><i class="fa fa-edit "></i> </a>
                              <?php }) ?>
                              <?php is_allowed('charroi_list', function() use ($suivi_vehicule){?>
                              <a title="Supprimer" href="javascript:void(0);" id="<?= $suivi_vehicule->ID_SUIVI ?>" class="btn btn-danger btn-xs remove-data bt_delete"><i class="fa fa-close"></i></a>
                               <?php }) ?>
                           </td>
                        </tr>
                      <?php endforeach; ?>
                      </tbody>
                    </table>
                  </div>
                </div>

                <hr>
                 <div class="row">
                    <div class="col-md-8">
                    </div>                
                    <div class="col-md-4">
                       <div class="dataTables_paginate paging_simple_numbers pull-right" id="example2_paginate" >
                          <?= $pagination; ?>
                       </div>
                    </div>
                 </div>

                 </div>
            </div>
            <!--/box body -->
         <!--/box -->
      </div>
   </div>
</section>
<!-- /.content -->

<!-- Page script -->

<script type="text/javascript">
   $(document).ready(function() {
    $(document).on('click', '.bt_delete', function() {

      var id = $(this).attr('id');

      swal({

          title: "Êtes-vous sûr?",
          text: "La suppression sera définitive; pas moyen de récupérer!",
          type: "warning",
          showCancelButton: true,
          confirmButtonColor: "#DD6B55",
          confirmButtonText: "Oui, Supprimer-le!",
          cancelButtonText: "Non, Annuler plx ",
          closeOnConfirm: true,
          closeOnCancel: true

        },
        function(isConfirm) {
          if (isConfirm) {
            // console.log(id);
            document.location.href = BASE_URL + 'administrator/suivi_vehicule/delete/<?= $this->uri->segment(4);?>/'+id;
            
         }
        }); //end swal

      return false;


    });
   })
</script>