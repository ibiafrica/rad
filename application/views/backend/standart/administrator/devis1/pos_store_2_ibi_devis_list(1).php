
<script src="<?= BASE_ASSET; ?>/js/jquery.hotkeys.js"></script>

<script type="text/javascript">
//This page is a result of an autogenerated content made by running test.html with firefox.
function domo(){
 
   // Binding keys
   $('*').bind('keydown', 'Ctrl+a', function assets() {
       window.location.href = BASE_URL + '/administrator/Pos_store_2_ibi_devis/add';
       return false;
   });

   $('*').bind('keydown', 'Ctrl+f', function assets() {
       $('#sbtn').trigger('click');
       return false;
   });

   $('*').bind('keydown', 'Ctrl+x', function assets() {
       $('#reset').trigger('click');
       return false;
   });

   $('*').bind('keydown', 'Ctrl+b', function assets() {

       $('#reset').trigger('click');
       return false;
   });
}

jQuery(document).ready(domo);
</script>
<style type="text/css">
  tr:hover td{
    background-color: #ccc !important;
  }
</style>
<!-- Content Header (Page header) -->
<section class="content-header">
   <h1>
      Devis<small></small>
   </h1>
   <ol class="breadcrumb">
      <li><a href="#"><i class="fa fa-dashboard"></i> Accueil</a></li>
      <li class="active">Devis</li>
   </ol>
</section>
<!-- Main content -->
<section class="content">
   <div class="row" >
      
      <div class="col-md-12">
         <div class="box box-warning">
            <div class="box-body ">
               <!-- Widget: user widget style 1 -->
               <div class="box box-widget widget-user-2">
                  <!-- Add the bg color to the header using any of the bg-* classes -->
                  <div class="widget-user-header ">
                     <div class="row pull-right">
                      

                  <?php is_allowed('pos_store_2_ibi_devis_add', function(){?>
                  <a class="btn btn-flat btn-success btn_add_new" id="btn_add_new" title="voir les devis en attentes" href="<?=  site_url('administrator/pos_store_2_ibi_devis/ibi_devis_liste_attente'); ?>"><i class="fa fa-list" ></i>&nbsp;&nbsp;Devis en attentes</a>
                     <?php }) ?>
                     </div>
                     <div class="widget-user-image">
                        <img class="img-circle" src="<?= BASE_ASSET; ?>/img/list.png" alt="User Avatar">
                     </div>
                     <!-- /.widget-user-image -->
                     <h3 class="widget-user-username"> Devis</h3>
                     <h5 class="widget-user-desc">Liste des commandes approuvées  <i class="label bg-yellow"><?= $pos_store_2_ibi_devis_counts; ?>  Elément<?php if($pos_store_2_ibi_devis_counts > 1)echo 's'; ?></i></h5>
                  </div>

                  <form name="form_pos_store_2_ibi_devis" id="form_pos_store_2_ibi_devis" action="<?= base_url('administrator/pos_store_2_ibi_devis/index'); ?>">
                  



















                  <div class="table-responsive"> 
                  <table class="table table-bordered table-striped dataTable">
                     <thead>
                        <tr style="background-color: #ccc !important;">
                           
                           <th style="text-align: center !important">&#8470; &nbsp;du devis</th>
                           <th style="text-align: center !important">Description</th>
                           <th style="text-align: center !important">Client</th>
                            <th style="text-align: center !important">Par</th>
                           <th style="text-align: center !important">Date de création</th>
                          
                           <th style="text-align: center !important">Action</th>
                        </tr>
                     </thead>
                     <tbody id="tbody_pos_store_2_ibi_devis">
                     <?php foreach($pos_store_2_ibi_deviss as $pos_store_2_ibi_devis): ?>
                        <tr>
                            <td style="text-align: center !important"><?= _ent($pos_store_2_ibi_devis->CODE_DEVIS); ?></td> 

                           <td style="text-align: center !important"><?= _ent($pos_store_2_ibi_devis->TITRE_DEVIS); ?></td> 
                          
                           <td style="text-align: center !important"><?= _ent($pos_store_2_ibi_devis->NOM_CLIENT); ?></td>

                          <td style="text-align: center !important"><?= _ent($pos_store_2_ibi_devis->full_name); ?></td> 

                         <td style="text-align: center !important"><?= _ent($pos_store_2_ibi_devis->DATE_CREATION_DEVIS); ?></td>
                             
                           <td style="text-align: center !important" width="200">

                         

                         <?php is_allowed('pos_store_2_ibi_devis_view', function() use ($pos_store_2_ibi_devis){?>
                              
                   <a  title="Créer un proforma" class="btn btn-primary btn-xs" data-toggle="modal" data-target="#myModal<?php echo $pos_store_2_ibi_devis->ID_DEVIS; ?>"><i class="fa fa-plus"></i></a>

                              <?php }) ?>




                              <?php is_allowed('pos_store_2_ibi_devis_update', function() use ($pos_store_2_ibi_devis){?>
                              <a href="<?= site_url('administrator/pos_store_2_ibi_devis/edit/' . $pos_store_2_ibi_devis->ID_DEVIS); ?>" class="btn btn-info btn-xs"><i class="fa fa-edit "></i> </a>
                              <?php }) ?>
                              <?php is_allowed('pos_store_2_ibi_devis_delete', function() use ($pos_store_2_ibi_devis){?>
                              <a href="javascript:void(0);" data-href="<?= site_url('administrator/pos_store_2_ibi_devis/delete/' . $pos_store_2_ibi_devis->ID_DEVIS); ?>" class="btn btn-danger btn-xs remove-data"><i class="fa fa-close"></i></a>
                               <?php }) ?>
                           </td>
                        </tr>





<!-- Modal -->
<div id="myModal<?php echo $pos_store_2_ibi_devis->ID_DEVIS; ?>" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Créer un proforma</h4>
      </div>  

      <div class="modal-body">
       
 <input type="hidden" class='id_devis<?php echo $pos_store_2_ibi_devis->ID_DEVIS; ?>'  name="id_devis" value="<?php echo $pos_store_2_ibi_devis->ID_DEVIS; ?>">

  <div class="row">

                          <div class="form-group ">
                            <label for="TITRE_FICHE" class="col-sm-2 control-label">Titre  
                            <i class="required">*</i>
                            </label>
                            <div class="col-sm-8">
                            
                                <input type="text" class="form-control" name="titre_proforma" id="TITRE_FICHE<?php echo $pos_store_2_ibi_devis->ID_DEVIS;?>" placeholder="Entrer un titre pour proforma" value="">
                                <small class="info help-block">
                                </small>
                            </div>
                        </div>

   </div>

 <div class="row">

               <div class="form-group ">
                            <label for="quantite" class="col-sm-2 control-label">Quantité
                            <i class="required">*</i>
                            </label>
                            <div class="col-sm-8">
                              <input type="number" class="form-control" name="quantitee" id="quantite<?php echo $pos_store_2_ibi_devis->ID_DEVIS;?>" placeholder="Entrer quantité à produire" value="">
                                <small class="info help-block">
                                </small>
                            </div>
                        </div>

   
            </div>



    <div class="row"> 
    <div class="form-group ">
                            <label for="quantite" class="col-sm-2 control-label">Remise
                            <i class="required">*</i>
                            </label>
                            <div class="col-sm-8">

<!-- 
<a data-toggle="modal" title="Ajouter une remise" data-target="#remiseId"class="btn btn-primary btn-xs"> <i class="fa fa-edit"></i> </a> -->




                            <a data-toggle="modal" title="Ajouter une remise" data-target="#remiseId"class="btn btn-primary btn-xs"> <i class="fa fa-edit"></i> </a><input type="hidden" value="<?php ?>" name="total">


                            </div>
        </div>

</div>





















          <div class="modal fade" id="remiseId">
                  <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-body">
                          <h4 class="text-center">Appliquer une remise : <span id="discount_type"><span class="label label-primary">au pourcentage</span></span></h4>
                          <span id="discount_price" style="display: none"></span>
                          <span id="discount_initial" style="display: none"></span>
                          <span id="discount_idart" style="display: none"></span>
                          <input type="hidden" class="discount_idart">
                          <div class="input-group input-group-lg">
                            <span class="input-group-btn">
                              <button class="btn btn-default percentage_discount active" id="percentage_discount" type="button">Pourcentage</button>
                            </span>
                            <input type="number" name="remise_applique" class="form-control discount_value remise_applique<?php echo $pos_store_2_ibi_devis->ID_DEVIS;?>" id="discount_value" value="0" placeholder="Définir le montant ou le pourcentage ici...">
                            <span class="input-group-btn">
                              <button class="btn btn-default flat_discount" id="flat_discount" type="button">Espèces
                                </button>
                            </span>
                          </div>
                        </div>
                        <div class="modal-footer">
                          <!-- <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button> -->
                          <button type="button" class="btn btn-primary" onclick="save_discount(this);">OK</button>
                          <!-- <button type="button" class="btn btn-primary save_discount">OK</button> -->
                        </div>
                      </div>
                    </div>
                  </div>





      </div>


      




<div class="modal-footer">
        <button type="button" class="btn btn-danger" data-dismiss="modal">Fermer</button>
        <button data-stype='back' class="btn btn-primary btn_save btn_action btn_save_back verifier"><input type="hidden" value="<?php echo $pos_store_2_ibi_devis->ID_DEVIS;?>" name="btnsend">Envoyer</button>
      </div>


<!-- 
    <button class="btn btn-flat btn-primary btn_save btn_action btn_save_back" type="submit" id="btn_save" data-stype='back' title="Créer un proforma">

    <i class="fa fa-save" ></i> Enregistrer

                            </button> -->





    </div>

  </div>
</div>


                      <?php endforeach; ?>



                      <?php if ($pos_store_2_ibi_devis_counts == 0) :?>
                         <tr style="color:red; text-align: center;">
                           <td colspan="100">
                           Pas du contenu à afficher
                           </td>
                         </tr>
                      <?php endif; ?>
                     </tbody>
                  </table>
                  </div>
               </div>
               <hr>












               <!-- /.widget-user -->
               <div class="row">
                  <div class="col-md-8">
                     <div class="col-sm-2 padd-left-0 " >
                        <select type="text" class="form-control chosen chosen-select" name="bulk" id="bulk" placeholder="Site Email" >
                           <option value="">Bulk</option>
                           <option value="delete">Delete</option>
                        </select>
                     </div>
                     <div class="col-sm-2 padd-left-0 ">
                        <button type="button" class="btn btn-flat" name="apply" id="apply" title="<?= cclang('apply_bulk_action'); ?>"><?= cclang('apply_button'); ?></button>
                     </div>
                     <div class="col-sm-3 padd-left-0  " >
                        <input type="text" class="form-control" name="q" id="filter" placeholder="<?= cclang('filter'); ?>" value="<?= $this->input->get('q'); ?>">
                     </div>
                     <div class="col-sm-3 padd-left-0 " >
                        <select type="text" class="form-control chosen chosen-select" name="f" id="field" >
                           <option value=""><?= cclang('all'); ?></option>
                            <option <?= $this->input->get('f') == 'TITRE_DEVIS' ? 'selected' :''; ?> value="TITRE_DEVIS">TITRE DEVIS</option>
                           <option <?= $this->input->get('f') == 'CODE_DEVIS' ? 'selected' :''; ?> value="CODE_DEVIS">CODE DEVIS</option>
                           <option <?= $this->input->get('f') == 'REF_CLIENT_DEVIS' ? 'selected' :''; ?> value="REF_CLIENT_DEVIS">REF CLIENT DEVIS</option>
                           <option <?= $this->input->get('f') == 'TYPE_DEVIS' ? 'selected' :''; ?> value="TYPE_DEVIS">TYPE DEVIS</option>
                           <option <?= $this->input->get('f') == 'DATE_CREATION_DEVIS' ? 'selected' :''; ?> value="DATE_CREATION_DEVIS">DATE CREATION DEVIS</option>
                           <option <?= $this->input->get('f') == 'DATE_MOD_DEVIS' ? 'selected' :''; ?> value="DATE_MOD_DEVIS">DATE MOD DEVIS</option>
                           <option <?= $this->input->get('f') == 'AUTHOR_DEVIS' ? 'selected' :''; ?> value="AUTHOR_DEVIS">AUTHOR DEVIS</option>
                           <option <?= $this->input->get('f') == 'COEFFICIENT_DEVIS' ? 'selected' :''; ?> value="COEFFICIENT_DEVIS">COEFFICIENT DEVIS</option>
                           <option <?= $this->input->get('f') == 'TOTAL_DEVIS' ? 'selected' :''; ?> value="TOTAL_DEVIS">TOTAL DEVIS</option>
                           <option <?= $this->input->get('f') == 'TOTAL_FINAL_DEVIS' ? 'selected' :''; ?> value="TOTAL_FINAL_DEVIS">TOTAL FINAL DEVIS</option>
                           <option <?= $this->input->get('f') == 'TYPE_DELAY_DEVIS' ? 'selected' :''; ?> value="TYPE_DELAY_DEVIS">TYPE DELAY DEVIS</option>
                           <option <?= $this->input->get('f') == 'TEMPS_DELAY_DEVIS' ? 'selected' :''; ?> value="TEMPS_DELAY_DEVIS">TEMPS DELAY DEVIS</option>
                           <option <?= $this->input->get('f') == 'COND_PAID_DEVIS' ? 'selected' :''; ?> value="COND_PAID_DEVIS">COND PAID DEVIS</option>
                           <option <?= $this->input->get('f') == 'PERCENT_PAID_DEVIS' ? 'selected' :''; ?> value="PERCENT_PAID_DEVIS">PERCENT PAID DEVIS</option>
                           <option <?= $this->input->get('f') == 'PERCENT_PAID_LIVR_DEVIS' ? 'selected' :''; ?> value="PERCENT_PAID_LIVR_DEVIS">PERCENT PAID LIVR DEVIS</option>
                           <option <?= $this->input->get('f') == 'VALID_OFFRE_DEVIS' ? 'selected' :''; ?> value="VALID_OFFRE_DEVIS">VALID OFFRE DEVIS</option>
                           <option <?= $this->input->get('f') == 'STATUT_DEVIS' ? 'selected' :''; ?> value="STATUT_DEVIS">STATUT DEVIS</option>
                          </select>
                     </div>
                     <div class="col-sm-1 padd-left-0 ">
                        <button type="submit" class="btn btn-flat" name="sbtn" id="sbtn" value="Apply" title="<?= cclang('filter_search'); ?>">
                        Filter
                        </button>
                     </div>
                     <div class="col-sm-1 padd-left-0 ">
                        <a class="btn btn-default btn-flat" name="reset" id="reset" value="Apply" href="<?= base_url('administrator/pos_store_2_ibi_devis');?>" title="<?= cclang('reset_filter'); ?>">
                        <i class="fa fa-undo"></i>
                        </a>
                     </div>
                  </div>
                  </form> 





 <?= form_open('', [

                'name'    => 'add_devis_form', 

                'class'   => 'add_devis_form', 

                'id'      => 'add_devis_form', 

                'enctype' => 'multipart/form-data', 

                'method'  => 'POST'

                            ]); ?>

 <input type="hidden" value="" name="ids_devis" id="ids_devis">                           

<input type="hidden" value="" name="titre" id="titre">

 <input type="hidden" value="" name="qte" id="qte">

 <input type="hidden" value="" name="type_remize" id="type_remize">

 <input type="hidden" value="" name="remise_appliques" id="remise_appliques">                           



<?= form_close(); ?>












                                   <div class="col-md-4">
                     <div class="dataTables_paginate paging_simple_numbers pull-right" id="example2_paginate" >
                        <?= $pagination; ?>
                     </div>
                  </div>
               </div>
            </div>
            <!--/box body -->
         </div>
         <!--/box -->
      </div>
   </div>

<!-- /.content -->

<!-- Page script -->
<script>
  $(document).ready(function(){


$('.verifier').click(function(){

var btnsend_value = $(this).find('input[name=btnsend]').val();
 
var id_divus = $('.id_devis'+btnsend_value).val();

var fiche = $('#TITRE_FICHE'+btnsend_value).val();

var quantite = $('#quantite'+btnsend_value).val();

var remise_applique = $('.remise_applique'+btnsend_value).val();


//alert(id_divus);

//var remise = $('.discount_value'+btnsend_value).val();

//var etat_value = $(".etat"+btnsend_value).children("option:selected").val();
//alert(fiche);

if(fiche ==''){
  sweetAlert('Donner un titre de fiche');
   return false;

}
else if(quantite ==''){
  sweetAlert('Donner la quantité à produire');
   return false;

}

else{

$('#ids_devis').val(id_divus);
$('#type_remize').val('espece');
$('#titre').val(fiche);
$('#qte').val(quantite);
$('#remise_appliques').val(remise_applique);


//var type_remize = $('#type_remize').val();

           // avoid_multi_click_btn('btn_save', 5000);

//var btnsend_value = $(this).find('input[name=btnsend]').val();
        //var proforma_idz = $('#proforma_id'+btnsend_value);







           // avoid_multi_click_btn('btn_save', 5000);


        var add_devis_form = $('#add_devis_form');

        var data_post = add_devis_form.serializeArray();

        var save_type = $(this).attr('data-stype');





        data_post.push({
          name: 'save_type',
          value: save_type
        });



        $('.loading').show();



        $.ajax({

             url: BASE_URL + '/administrator/pos_store_2_ibi_proforma/add_save',
            //url: BASE_URL + '/administrator/project_bon_retour_caisse/add_savedata',

            type: 'POST',

            dataType: 'json',

            data: data_post,

          })

          .done(function(res) {

            if (res.success) {



              if (save_type == 'back') {

                window.location.href = res.redirect;

                return;

              }



              $('.message').printMessage({
                message: res.message
              });

              $('.message').fadeIn();

              resetForm();

              $('.chosen option').prop('selected', false).trigger('chosen:updated');



            } else {

              $('.message').printMessage({
                message: res.message,
                type: 'warning'
              });

            }



          })

          .fail(function() {

            $('.message').printMessage({
              message: 'Error save data',
              type: 'warning'
            });

          })

          .always(function() {

            $('.loading').hide();

            $('html, body').animate({
              scrollTop: $(document).height()
            }, 2000);

          });





}

      return false;

    });























   
    $('.remove-data').click(function(){

      var url = $(this).attr('data-href');

      swal({
          title: "<?= cclang('are_you_sure'); ?>",
          text: "<?= cclang('data_to_be_deleted_can_not_be_restored'); ?>",
          type: "warning",
          showCancelButton: true,
          confirmButtonColor: "#DD6B55",
          confirmButtonText: "<?= cclang('yes_delete_it'); ?>",
          cancelButtonText: "<?= cclang('no_cancel_plx'); ?>",
          closeOnConfirm: true,
          closeOnCancel: true
        },
        function(isConfirm){
          if (isConfirm) {
            document.location.href = url;            
          }
        });

      return false;
    });


  /*end appliy click*/
   });



</script>

<script type="text/javascript">
  function getRidOfTheComma(data){
      var toReturn = "";
      var toFilter = data.split("");
      const toMakeString = toFilter.filter(element => element !== ",");
      const times = toMakeString.length;
      for(i=0; i<times; i++){
          toReturn += toMakeString[i];
      }
      return toReturn;
  }

  function stringToNumber(data){
      var toReturn = 0;
      var toMakeInt = "";
      if(data === ""){
          return toReturn;
      } else {
          toMakeInt = getRidOfTheComma(data);
          toReturn = parseFloat(toMakeInt);
          return toReturn;
      }
  }
  function toRemise(data){
    $("#remiseId").modal();
    const initial = stringToNumber($(data).closest('tr').find('td div input').val());
    const price = stringToNumber($(data).closest('tr').find('td.price').text());
    const idart = ($(data).closest('tr').attr('id'));
   
    document.getElementById('discount_price').innerHTML = price;
    document.getElementById('discount_initial').innerHTML = initial;
    // document.getElementById('discount_idart').innerHTML = idart;
    $('.discount_idart').val(idart);
  }
  function save_discount(data){
       const discount_type = document.getElementById("discount_type").innerHTML;
       const discount_price = document.getElementById("discount_price").innerHTML;
       const discount_initial = document.getElementById("discount_initial").innerHTML;
       // const discount_idart = document.getElementById("discount_idart").innerHTML;
       const discount_idart = $('.discount_idart').val();
       const discount_value = $('.discount_value').val();

      if(discount_type == 'Espèces'){
      
        // if(discount_value = discount_price){
        //       alert('La remise fixe ne peut pas excéder la valeur actuelle du panier. Le montant de la remise à été réduite à la valeur du panier.');
        //       document.getElementById('remise'+discount_idart+'').innerHTML = discount_price;
        //       $('#remiseId').modal('hide');
        // }else 
        if(discount_value == ''){
                // document.getElementById('remise'+discount_idart+'').innerHTML = 0;
                $('#remise'+discount_idart+'').text(0);
                $('.remise'+discount_idart+'').val(0);
                $('#remiseId').modal('hide');
          }else{
           const price = discount_price * discount_initial - discount_value;
           // document.getElementById('remise'+discount_idart+'').innerHTML = discount_value;
           $('#remise'+discount_idart+'').text(discount_value);
           $(data).closest('tr').find('td.total').text(price);
           $('.remise'+discount_idart+'').val(discount_value);
           $('#remiseId').modal('hide');
        }
           
        }else if(discount_type == 'Pourcentage'){
          if(discount_value>100){
                // document.getElementById('remise'+discount_idart+'').innerHTML = 100+'%';
                $('#remise'+discount_idart+'').text(100+'%');
                $('.remise'+discount_idart+'').val(100+'%');
                $('#remiseId').modal('hide');
          }else if(discount_value == ''){
                $('#remise'+discount_idart+'').text(0+'%');
                $('.remise'+discount_idart+'').val(0+'%');
                $('#remiseId').modal('hide');
          }else{
               // document.getElementById('remise'+discount_idart+'').innerHTML = discount_value+'%';
               $('#remise'+discount_idart+'').text(discount_value+'%');
               $('.remise'+discount_idart+'').val(discount_value+'%');
               $('#remiseId').modal('hide');
          }
           
        }else{
          if(discount_value>100){
                // document.getElementById('remise'+discount_idart+'').innerHTML = 100+'%';
                $('#remise'+discount_idart+'').text(100+'%');
                $('.remise'+discount_idart+'').val(100+'%');
                $('#remiseId').modal('hide');
          }else if(discount_value == ''){
                $('#remise'+discount_idart+'').text(0+'%');
                $('.remise'+discount_idart+'').val(0+'%');
                $('#remiseId').modal('hide');
          }else{
               // document.getElementById('remise'+discount_idart+'').innerHTML = discount_value+'%';
               $('#remise'+discount_idart+'').text(discount_value+'%');
               $('.remise'+discount_idart+'').val(discount_value+'%');
               $('#remiseId').modal('hide');
          }
        }
    }
  function toDelete(data){
    $(data).closest('tr').remove();
    const idex = articleTable.indexOf($(data).closest('tr').attr("id"));
    articleTable.splice(idex, 1);
  }
  function moins(data){
    const initial = stringToNumber($(data).closest('tr').find('td div input').val());
    const price = stringToNumber($(data).closest('tr').find('td.price').text());
    const qty = initial - 1;
    if(qty <= 0){
      $(data).closest('tr').remove();
      const idex = articleTable.indexOf($(data).closest('tr').attr("id"));
      articleTable.splice(idex, 1);
    } else {
      $(data).closest('tr').find('td div input').val(qty);
      $(data).closest('tr').find('td.total').text(price * qty);
    }
  }

  function plus(data){
    const initial = stringToNumber($(data).closest('tr').find('td div input').val());
    const price = stringToNumber($(data).closest('tr').find('td.price').text());
    const qty = initial + 1;
  
    $(data).closest('tr').find('td div input').val(qty);
    $(data).closest('tr').find('td.total').text(price * qty);


  }
  function search(data){
    const quantRest = $(data).closest('tr').find("td.quantRest").text();
    const initial = stringToNumber($(data).closest('tr').find('td div input').val());
    const price = stringToNumber($(data).closest('tr').find('td.price').text());
 
      $(data).closest('tr').find('td div input').val(initial);
      $(data).closest('tr').find('td.total').text(price * initial);
    
    }

    $(document).ready(function(){

      
      $('.flat_discount').on('click',function(){
        document.getElementById('discount_type').innerHTML = 'Espèces';

        //$(this).find('input[name=type_remize]').val('espece');


 $('#type_remize').val('espece');

 //var v= $('#type_remize').val();

//alert(v);

      });
      $('.percentage_discount').on('click',function(){
        document.getElementById('discount_type').innerHTML = 'Pourcentage';
      });

      $('#temps').on('change',function(){
             var temps =$('#temps').val();
             if(temps===''){
              $('#delai1').hide();$('#delai').show();
             }else{
             $('#delai1').show();
             $('#delai').hide(); }
      });
      $('#condPayer').on('change',function(){
        var condPayer=$('#condPayer').val(); 
        if(condPayer=='1'){
          $('#customer').hide();
        }else{
           $('#customer').show();
        }
            
      });

    var combobox = document.getElementById("combobox");
    var articleOption = document.getElementsByClassName("articleOption");
    
    $("#myInput").on('keyup', function(){
      var input, filter, ul, li, a, i, txtValue;

      input = document.getElementById('myInput');
      filter = input.value.toUpperCase();
      ul = document.getElementById("myUL");
      li = ul.getElementsByTagName('li'); 

      if(input.value === ""){
        $("#list").attr("hidden", 'true');
      } else {
        $("#list").removeAttr("hidden");
        for (i = 0; i < li.length; i++) {
          a = li[i].getElementsByTagName("a")[0];
          txtValue = a.textContent || a.innerText;
          if (txtValue.toUpperCase().indexOf(filter) > -1) {
            li[i].style.display = "";
          } else {
            li[i].style.display = "none";
          }
        }
      }
    });

    $('.articleOption').on('click',function(){ 

            const code_proforma = $(this).attr("code_proforma");
            const ref_client = $(this).attr("ref_client");
            const store_prefix = $('#store_prefix').val();
            const store_uri = $('#store_uri').val();

            $.ajax({
                url: BASE_URL + '/administrator/registers/generate_commande_post',
                method:'POST',
                data:{code_proforma:code_proforma,ref_client:ref_client,store_prefix:store_prefix,store_uri:store_uri},
                dataType:'json',

                success:function(data){ 
                  $("#list").attr("hidden", 'true');
                  $('#tableProforma').html(data.tableau);
                }
            });
        });

    /*document ready*/
});

</script>
<style type="text/css">
  #myUL {
    /* Remove default list styling */
    list-style-type: none;
    padding: 0;
    margin: 0;
  }
  #myUL li a {
    border: 1px solid #ddd; /* Add a border to all links */
    margin-top: -1px; /* Prevent double borders */
    background-color: #f6f6f6; /* Grey background color */
    padding: 12px; /* Add some padding */
    text-decoration: none; /* Remove default text underline */
    font-size: 18px; /* Increase the font-size */
    color: black; /* Add a black text color */
    display: block; /* Make it into a block element to fill the whole list */
  }
  
  #myUL li a:hover:not(.header) {
    background-color: #eee; /* Add a hover effect to all links, except for headers */
  }
</style>