<script>
  $(function() {
    $('.chosen-select').chosen();
    $('.chosen-select-deselect').chosen({
      allow_single_deselect: true
    });
  });
</script>

<style>
  .list-group-item:hover {
    background-color: #cccccc4a !important;
    cursor: pointer;
  }
</style>

<script src="<?= BASE_ASSET; ?>/js/jquery.hotkeys.js"></script>

<script type="text/javascript">
  //This page is a result of an autogenerated content made by running test.html with firefox.
  function domo() {

    // Binding keys
    $('*').bind('keydown', 'Ctrl+a', function assets() {
      window.location.href = BASE_URL + '/administrator/pos_ibi_commandes/add';
      return false;
    });

    $('*').bind('keydown', 'Ctrl+f', function assets() {
      $('#sbtn').trigger('click');
      return false;
    });

    $('*').bind('keydown', 'Ctrl+x', function assets() {
      $('#reset').trigger('click');
      return false;
    });

    $('*').bind('keydown', 'Ctrl+b', function assets() {

      $('#reset').trigger('click');
      return false;
    });
  }

  jQuery(document).ready(domo);
</script>
<!-- Content Header (Page header) -->
<section class="content-header">
  <h1>
    Pos Ibi Commandes </h1>
  <ol class="breadcrumb">
    <li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
    <li class="active">Pos Ibi Commandes</li>
  </ol>
</section>
<!-- Main content -->
<section class="content">
  <div class="row">

    <div class="col-md-12">
      <div class="box box-warning">
        <div class="box-body ">
          <!-- Widget: user widget style 1 -->


          <form name="form_pos_ibi_commandes" id="form_pos_ibi_commandes" action="<?= base_url('administrator/pos_ibi_commandes/index'); ?>">

            <!-- /.widget-user -->
            <div class="row">

              <div class="row">

                <div class="col-md-12">

                  <div class="col-lg-5 col-md-5 col-sm-5">

                    <div class="input-group">
                      <div class="input-group-addon">
                        DU
                      </div>
              <input type="date" name="DEBUT" class="form-control datepicker DEBUT" value="<?php if ($start != '') { echo $start; } ?>">
                    </div>
                  </div>

                  <div class="col-lg-5 col-md-5 col-sm-5">

                    <div class="input-group">
                      <div class="input-group-addon">
                        AU
                      </div>
                      <input type="date" name="FIN" class="form-control datepicker FIN" value="<?php if ($end != '') {
                                            echo $end;
                                          }
                                          ?>">
                    </div>
                  </div>

                  <div class="col-md-1">

                    <button type="button" class="btn btn-flat" name="sbtns" id="sbtns" value="Applys" title="<?= ('Detaille'); ?>">
                        <i class="fa fa-list"></i> Details
                      </button>
                        
                      </a>
                    
                  </div>
                </div>



              </div>

              <br />

              <div class="row">

                <div class="col-sm-12 col-md-12" style="">

                  <div class="col-sm-5" style="border: 0px solid;">
                    <input type="text" class="form-control" name="q" id="filter" placeholder="<?= 'Recherher'; ?>" value="<?= $this->input->get('q'); ?>">
                  </div>

                  <!-- <div class="col-sm-3" style="border: 0px solid;">
                   
                    <select name="shift" class="form-control chosen chosen-select">
                      <option value="">Tout les Shift</option>
                      <?php

                      $requete = $this->db->query('SELECT c.*,a.* FROM cashier_shifts c,aauth_users a WHERE c.CREATED_BY_SHIFT=a.id AND c.SHIFT_STATUS=1 ORDER BY c.ID_SHIFT DESC')->result();

                      foreach ($requete as $row) : ?>

                        <option value="<?php echo $row->ID_SHIFT; ?>">
                          De
                          <?php echo ($row->SHIFT_START); ?>
                          A

                          <?php echo ($row->SHIFT_END); ?>
                        </option>
                      <?php endforeach; ?>
                    </select>
                  </div> -->


                  <div class="col-sm-4" style="border: 0px solid;">
                    <select class="form-control" name="status">
                      <option value="">Tout </option>
                      <option value="2">
                        Complete
                      </option>
                      <option value="0">
                        En attente
                      </option>
                      <option value="10">
                        Credit
                      </option>
                      <option value="11">
                        Complementaire
                      </option>
                    </select>
                  </div>

                  <div class="col-sm-3" style="border: 0px solid;">
                    <input type="hidden" name="f" id="field">
                    <div class="col-sm-12 padd-left-0 ">
                      <button type="submit" class="btn btn-flat" name="sbtn" id="sbtn" value="Apply" title="<?= cclang('filter_search'); ?>">
                        <i class="fa fa-search"></i>
                      </button>
                      <a class="btn btn-default btn-flat" name="reset" id="reset" value="Apply" href="<?= base_url('administrator/pos_ibi_commandes/index'); ?>" title="Réinitialiser la recherche">
                        <i class="fa fa-undo"></i>
                      </a>

                            <button class="btn btn-default" onclick="tableToExcel('table_cmd', '')">
                          <span class="glyphicon glyphicon-share"></span>
                          Export xls
                         </button>
                    </div>


                    <!-- <div class="col-sm-8">
                    <?php

                    $statut;
                    if ($statut != null) { ?>
                      <a class="btn btn-flat btn-success" title="<?= cclang('export'); ?> Pos Ibi Commandes" href="<?= site_url('administrator/pos_ibi_commandes/det_pdf_detail_by_status/' . $statut); ?>"><i class="fa fa-file-pdf-o"></i> </a>
                    <?php  }

                    ?>

                  </div> -->
                  </div>
                </div>

              </div>

            </div>

          </form>

          <br>

          <div id="confirmedit" style="display: none" class="modal" id="myModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h3 class="modal-title" id="exampleModalLabel"> Choissez le type de modification</h3>
                </div>
                <div class="modal-body" style="display: flex;justify-content: space-around">
                  <button type="button" class="btn btn-info confirmEdit" data-type="1">
                    Ajouter à la commande
                  </button>
                  <button type="button" class="btn btn-success confirmEdit" data-type="2">Retirer à la commande</button>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary cancelEdit">Close</button>

                </div>
              </div>
            </div>
          </div>
          <div class="col-md-12">

            <?php

            if ($total_somme != 0) {
            ?>
              <div class="alert alert-default bg-info" style="padding:0px">
                <h3 class="text-center "> La sommes des commandes est de : <?php echo $total_somme; ?> Fbu</h3>
              </div>
            <?php }

            ?>

            <div class="table-responsive row">
              <table class="table table-bordered table-striped dataTable" id="table_cmd">
                <thead>
                  <tr class="">

                    <th>Code</th>
                    <th>Client</th>
                    <th>Table</th>
                    <th>Status</th>
                    <th>OBR</th>
                    <!-- <th>Montant</th> -->
                    <th>Date creation</th>
                    <th>Creer par</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody id="tbody_pos_ibi_commandes">
                  <?php foreach ($pos_ibi_commandess as $pos_ibi_commandes) : ?>
                    <tr>
                      
                      <td><?= _ent($pos_ibi_commandes->CODE); ?></td>
                      <td><?php
                          $id_client = _ent($pos_ibi_commandes->CLIENT_ID_COMMANDE);
                          $query = $this->db->get_where('pos_clients', array('ID_CLIENT' => $id_client));
                          if ($query->num_rows() > 0) {
                            echo $query->row()->NOM_CLIENT . '  ' . $query->row()->PRENOM;
                          }

                          ?></td>

                      <td>

                        <?php
                        $id_table = _ent($pos_ibi_commandes->TABLE_ID);
                        $query = $this->db->get_where('pos_ibi_commande_location', array('ID_COMMANDE_LOCATION' => $id_table, 'DELETE_STATUS' => 0));
                        if ($query->num_rows() > 0) {
                          echo $query->row()->DESIGNATION;
                        }

                        ?>

                      </td>
                      <td>
                        <?php
                        $status = $pos_ibi_commandes->COMMANDE_STATUS;
                        if ($status == 0) {
                          echo '<span class="bg-yellow badge">Impayer</span>';
                        } elseif ($status == 1) {
                          echo '<span class="bg-blue badge">En avance</span>';
                        } elseif ($status == 2) {
                          echo '<span class="bg-green badge">Complete</span>';
                        } elseif ($status == 11) {
                          echo '<span class="bg-green badge">Complementaire</span>';
                        } elseif ($status == 10) {
                          echo '<span class="bg-red badge">Credit</span>';
                        } else {
                          echo '<span class="bg-blue badge">Encours</span>';
                        }

                        ?>
                      </td>

                      <!-- <td>0 Fbu</td> -->

                      <td class="">
                        <?php $OBR = $pos_ibi_commandes->STATUS_OBR;
                        if ($OBR == 0) {
                          echo 'NON';
                        } else {
                          echo 'OUI';
                        } ?></td>
                      <td><?= _ent($pos_ibi_commandes->DATE_CREATION_POS_IBI_COMMANDES); ?></td>
                      <td><?php
                          $id_user = _ent($pos_ibi_commandes->CREATED_BY_POS_IBI_COMMANDES);
                          echo get_name_user($id_user);
                          ?></td>
                      <td width="150">

                        <?php /*is_allowed('pos_ibi_commandes_view', function () use ($pos_ibi_commandes) { ?>
                          <a href="<?= base_url('administrator/pos_ibi_commandes/factures_journaliere/' . $pos_ibi_commandes->ID_POS_IBI_COMMANDES) ?>" class="btn_produit_data btn btn-default btn-xs"><i class="fa fa-arrow-right"></i></a>
                        <?php })*/ ?>

                        <?php $status = $pos_ibi_commandes->COMMANDE_STATUS; ?>
                        <?php /*if ($status == 0) : ?>
                          <?php is_allowed('pos_ibi_commandes_addModify', function () use ($pos_ibi_commandes) { ?>
                            <button data-cmdid="<?= $pos_ibi_commandes->ID_POS_IBI_COMMANDES; ?>" style="margin-right: 2px" class="btn btn-warning btn-xs btnoptions"><i class="fa fa-plus"></i> <i class="fa fa-edit"></i></button>
                          <?php }) ?>

                        <?php endif;*/ ?>

                        <?php is_allowed('pos_ibi_commandes_facture', function () use ($pos_ibi_commandes) { ?>
                          <a href="<?= base_url('administrator/pos_ibi_commandes/facture_view/' . $pos_ibi_commandes->ID_POS_IBI_COMMANDES) ?>" style="margin-right: 2px" data-title="facture" data-id="<?php echo $pos_ibi_commandes->ID_POS_IBI_COMMANDES ?>" class="btn_produit_data btn btn-default btn-xs"><i class="fa fa-th-list"></i></a>
                        <?php }) ?>

                        <?php is_allowed('pos_ibi_commandes_view', function () use ($pos_ibi_commandes) { ?>
                          <a style="margin-right: 2px" data-title="paiement" href="<?= site_url('administrator/pos_ibi_commandes/view/' . $pos_ibi_commandes->ID_POS_IBI_COMMANDES); ?>" class="btn bg-green btn-xs" title="payer"><i class="fa fa-money"></i></a>
                        <?php }) ?>


                        <?php if (4 > 1) : ?>

                          <?php is_allowed('pos_ibi_commandes_trans', function () use ($pos_ibi_commandes) { ?>
                            <button onclick="setCmdId(<?php echo $pos_ibi_commandes->ID_POS_IBI_COMMANDES ?>)" data-toggle="modal" data-target="#myModalclient" style="margin-right: 2px" data-title="facture" data-id="" class="btn_produit_data btn btn-success btn-xs" title="transferer"><i class="fa fa-arrow-right"></i></button>
                          <?php }) ?>

                        <?php endif; ?>
                        <?php is_allowed('pos_ibi_commandes_bon', function () use ($pos_ibi_commandes) { ?>
                          <button data-toggle="modal" data-target="#myModalbon<?php echo $pos_ibi_commandes->ID_POS_IBI_COMMANDES ?>" style="margin-right: 2px" data-title="Bon de commandes" data-id="" class="btn btn-success btn-xs" title="bons"><i class="fa fa-list"></i></button>
                        <?php }) ?>

                        <?php /*if ($pos_ibi_commandes->COMMANDE_STATUS == 0) : ?>
                          <?php is_allowed('pos_ibi_commandes_delete', function () use ($pos_ibi_commandes) { ?>
                            <a class="btn btn-danger btn-xs remove-data" data-href="<?= base_url('administrator/pointdesventes/delete/0') . "/" . $pos_ibi_commandes->ID_POS_IBI_COMMANDES . "/0" ?>"><i class="fa fa-close"></i></a>
                          <?php }) ?>
                        <?php endif;*/ ?>
                      </td>
                    </tr>




                    <div id="myModalbon<?= $pos_ibi_commandes->ID_POS_IBI_COMMANDES; ?>" class="modal fade" role="dialog">
                      <div id="fileToPrint" class="modal-dialog">
                        <!-- Modal content-->
                        <div class="modal-content">
                          <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                            <h4 class="modal-title">Bons de commande</h4>
                          </div>
                          <div class="modal-body" id="targets_<?= $pos_ibi_commandes->ID_POS_IBI_COMMANDES; ?>">
                            <div>


                              <?php foreach ($pos_ibi_commandes->BON as $bon_cmd) : ?>
                                <p>BON POUR : <strong><?php echo $bon_cmd[0]->NAME_STORE;  ?></strong></p>
                                <p>CODE COMMANDE: <?php echo $pos_ibi_commandes->BON[0][0]->REF_COMMAND_CODE;  ?></p>
                                <div style="width: 100%;display:flex;justify-content: space-between; font-weight:bold;border-bottom: 1px solid #ccc">
                                  <p style="width: 23rem">Designation</p>
                                  <p>Qté</p>
                                  <p>P.u</p>
                                  <p>Remise</p>
                                  <p>Total</p>
                                </div>
                                <?php foreach ($bon_cmd as $prod) : ?>
                                  <div style="width: 100%;display: flex;justify-content:space-between">
                                    <p style="width: 23rem"><?= $prod->NAME; ?></p>
                                    <p><?= $prod->QUANTITE; ?></p>
                                    <p><?= $prod->PRIX_VENDU; ?></p>
                                    <p><?= $prod->DISCOUNT_PERCENT; ?></p>
                                    <p><?= (($prod->QUANTITE * $prod->PRIX_VENDU) - (($prod->QUANTITE * $prod->PRIX_VENDU) * $prod->DISCOUNT_PERCENT / 100)); ?></p>
                                  </div>
                                <?php endforeach; ?>
                                </br>
                                </hr>
                              <?php endforeach; ?>
                            </div>
                          </div>
                          <div class="modal-footer">
                            <button type="button" class="btn btn-default prints" data-attr="<?php echo $pos_ibi_commandes->ID_POS_IBI_COMMANDES;   ?>">Imprimer</button>
                            <button type="button" class="btn btn-default" data-dismiss="modal">Retour</button>

                          </div>
                        </div>

                      </div>
                    </div>
                  <?php endforeach; ?>
            </div>
            <div id="myModalclient" class="modal fade" role="dialog">
              <div class="modal-dialog">
                <!-- Modal content-->
                <div class="modal-content">
                  <div class="modal-header">

                    <h4 class="modal-title">Transferer la commande</h4>
                  </div>
                  <div class="modal-body" id="target_<?php echo $pos_ibi_commandes->ID_POS_IBI_COMMANDES;  ?>">
                    <div>
                      <div class="form-group">
                        <input placeholder="Recherche" type="text" class="form-control" id="clientFilter">
                      </div>
                      <ul style="height: 300px; overflow-y: scroll; " class="list-group" id="clientlist">

                      </ul>
                    </div>
                  </div>
                  <div class="modal-footer" id="clientfooter">

                  </div>
                </div>

              </div>
            </div>
            <?php if ($pos_ibi_commandes_counts == 0) : ?>
              <tr>
                <td colspan="100">
                  Pas de donnees disponible.
                </td>
              </tr>
            <?php endif; ?>
            </tbody>
            </table>
          </div>
        </div>
        <hr>


        <div id="GSCCModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times; </button>
                <h4 class="modal-title" id="myModalLabel">Listes des touts les Shifts</h4>
              </div>
              <div class="modal-body">
                <input type="text" class="form-control" id="filters">
                <br>
                <ul class="list-group" id="item">
                </ul>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Fermer</button>
                <button type="button" class="btn btn-primary">Confirmer</button>
              </div>
            </div>
          </div>
        </div>


        <div class="row">
          <div class="col-md-4" style="float:right">
            <div class="dataTables_paginate paging_simple_numbers pull-right" id="example2_paginate">
              <?= $pagination; ?>
            </div>
          </div>
        </div>

      </div>
      <!--/box body -->
    </div>
    <!--/box -->
  </div>
  </div>
</section>

<script>
  var selectedCmdId = undefined;

  function setCmdId(id) {
    selectedCmdId = id;
  }
</script>

<script>
  const clientList = <?= $clients_list; ?>;
  let activeClient = undefined;

  (() => {
    console.log("onnnnnn...");
    $("#clientFilter").on('keyup', () => {
      const filter = $("#clientFilter").val();
      displayList(filter);
    });
  })();

  function confirmTransfert() {
    console.log("confirming...", activeClient, selectedCmdId);
    fetch(`<?= base_url(); ?>/administrator/pos_ibi_commandes/transfer_command/${activeClient}/${selectedCmdId}`)

      // .then(data => data.json())
      .then(res => {
        //console.log('uuuuuuuuuuuuuuuu')
        $('#table_cmd').load(' #table_cmd');
        // window.location.reload();
      })

  }

  function cancelTransfert() {
    setTimeout(() => {
      activeClient = undefined;
      selectedCmdId = undefined;
      displayList("");
      $("#clientFilter").val("");
    }, 500);
    setTimeout(() => handleBtn(), 1000);
  }

  function handleBtn() {
    $("#clientfooter").html("");
    if (!!activeClient) {
      $("#clientfooter").append(` <button type="button" class="btn btn-default" onclick="confirmTransfert()" data-dismiss="modal">Confirmer</button><button type="button" onclick="cancelTransfert()" class="btn btn-default" data-dismiss="modal">Retour</button>`);
    } else {
      $("#clientfooter").append(` <button type="button" class="btn btn-default" onclick="cancelTransfert()" data-dismiss="modal">Retour</button>`);
    }
  }

  handleBtn();


  function setCurrentClient(cl) {
    if (!!activeClient) {
      $(`#${activeClient}`).removeClass('active');
    }
    activeClient = cl;
    $(`#${cl}`).addClass('active');
    handleBtn();
  }

  function displayList(filter) {
    let todisplayList = '';
    $("#clientlist").html("");
    const filteredClients = clientList.filter(
      (c) => c.NOM_CLIENT.toLowerCase().match(filter.toLowerCase()) ||
      c.PRENOM.toLowerCase().match(filter.toLowerCase()));
    console.log(filteredClients);
    filteredClients.forEach(l => {
      todisplayList += `
      <li onclick="setCurrentClient(${l.ID_CLIENT})" class="list-group-item" id="${l.ID_CLIENT}">${l.NOM_CLIENT} ${l.PRENOM}</li>
      `;
    })
    $("#clientlist").append(todisplayList);
  }
  displayList("");
</script>

<script>
  $('.print').on('click', function() {
    const id = $(this).attr('data-attr');
    console.log(" Vous etes  " + id);
    var table = document.getElementById('target_' + id);
    // console.log(table);
    var ctx = table.outerHTML;
    var idname = name;
    var frame1 = document.createElement('iframe');
    frame1.name = "frame1";
    frame1.style.position = "absolute";
    frame1.style.top = "-1000000px";
    document.body.appendChild(frame1);
    var frameDoc = frame1.contentWindow ? frame1.contentWindow : frame1.contentDocument.document ? frame1
      .contentDocument.document : frame1.contentDocument;
    frameDoc.document.open();
    frameDoc.document.write('<html><head><title></title>');
    frameDoc.document.write(
      '<style>body{margin:10px !important}table {  border-collapse: collapse;  border-spacing: 0; width:100%; margin-top:20px;} .table td, .table > tbody > tr > td, .table > tbody > tr > th, .table > tfoot > tr > td, .table > tfoot > tr > th, .table > thead > tr > td, .table > thead > tr > th{ padding:8px 18px;border:1px  } .table-bordered, .table-bordered > tbody > tr > td, .table-bordered > tbody > tr > th, .table-bordered > tfoot > tr > td, .table-bordered > tfoot > tr > th, .table-bordered > thead > tr > td, .table-bordered > thead > tr > th {     border: 1px solid #000;}p + p { margin-left: 30px;}.body{width:100% !important}.no{display:none !important} </style>'
    ); // your title
    frameDoc.document.title = "Facture";
    frameDoc.document.write('<meta charset="utf-8"></head><body>');
    frameDoc.document.write(ctx);
    frameDoc.document.write('</body></html>');
    frameDoc.document.close();
    setTimeout(function() {
      window.frames["frame1"].focus();
      window.frames["frame1"].print();
      document.body.removeChild(frame1);
    }, 100);

  });
</script>

<script>
  $('.prints').on('click', function() {
    const id = $(this).attr('data-attr');
    console.log(" Vous etes  " + id);
    var table = document.getElementById('targets_' + id);
    // console.log(table);
    var ctx = table.outerHTML;
    var idname = name;
    var frame1 = document.createElement('iframe');
    frame1.name = "frame1";
    frame1.style.position = "absolute";
    frame1.style.top = "-1000000px";
    document.body.appendChild(frame1);
    var frameDoc = frame1.contentWindow ? frame1.contentWindow : frame1.contentDocument.document ? frame1
      .contentDocument.document : frame1.contentDocument;
    frameDoc.document.open();
    frameDoc.document.write('<html><head><title></title>');
    frameDoc.document.write(
      '<style>body{margin:10px !important}table {  border-collapse: collapse;  border-spacing: 0; width:100%; margin-top:20px;} .table td, .table > tbody > tr > td, .table > tbody > tr > th, .table > tfoot > tr > td, .table > tfoot > tr > th, .table > thead > tr > td, .table > thead > tr > th{ padding:8px 18px;border:1px  } .table-bordered, .table-bordered > tbody > tr > td, .table-bordered > tbody > tr > th, .table-bordered > tfoot > tr > td, .table-bordered > tfoot > tr > th, .table-bordered > thead > tr > td, .table-bordered > thead > tr > th {     border: 1px solid #000;}p + p { margin-left: 30px;}.body{width:100% !important}.no{display:none !important} </style>'
    ); // your title
    frameDoc.document.title = "Facture";
    frameDoc.document.write('<meta charset="utf-8"></head><body>');
    frameDoc.document.write(ctx);
    frameDoc.document.write('</body></html>');
    frameDoc.document.close();
    setTimeout(function() {
      window.frames["frame1"].focus();
      window.frames["frame1"].print();
      document.body.removeChild(frame1);
    }, 100);

  });
</script>


<script>
  var selectedcmd = undefined;
  $(document).ready(function() {

    $('#sbtns').click(function() {

      let debut = $('.DEBUT').val();
      let fin = $('.FIN').val();

      if (debut == '' || fin=='') {
             alert("Vous devriez entrer la date !")
         } else {
             $.ajax({
                 url: "<?php echo base_url('administrator/pos_ibi_commandes/detail_commandes')  ?>",
                 method: "POST",
                 data: {
            debut: debut,
            fin: fin,"<?php echo $this->security->get_csrf_token_name(); ?>": "<?php echo $this->security->get_csrf_hash(); ?>"},
                 success: function(data) {
                     //location.href = "<?php echo base_url() ?>administrator/pos_ibi_commandes/detail_commandes";
                 }
             });
         }
     }
    )

    console.log("okayl....");
    $('.btnoptions').click(function(e) {
      selectedcmd = $(this).data('cmdid');
      $("#confirmedit").show();
    });

    $('.confirmEdit').on('click', function() {
      const num = $(this).data('type');
      window.location.href = "<?= site_url('administrator/pointdesventes/update_commande/'); ?>" + selectedcmd + '/' + num;
    });
    $('.cancelEdit').on('click', function() {
      $("#confirmedit").hide();
    });


    $('.remove-data').click(function() {

      var url = $(this).attr('data-href');

      swal({
          title: "<?= cclang('are_you_sure'); ?>",
          text: "<?= cclang('data_to_be_deleted_can_not_be_restored'); ?>",
          type: "input",
          showCancelButton: true,
          confirmButtonColor: "#DD6B55",
          confirmButtonText: "<?= cclang('yes_delete_it'); ?>",
          cancelButtonText: "<?= cclang('no_cancel_plx'); ?>",
          closeOnConfirm: true,
          closeOnCancel: true,
          animation: "slide-from-top",
          inputPlaceholder: "Donnez un commentaire S.V.P."
        },
        function(inputValue) {
          if (inputValue === false) {
            return false;
          }
          if (inputValue === "") {
            swal.showInputError("Vous devriez ecrire un commentaire SVP.!!!");
            return false;
          }
          document.location.href = url + '?inputValue=' + inputValue;
        },
        function(isConfirm) {
          // if (isConfirm) {
          // document.location.href = BASE_URL + '/administrator/pos_ibi_commandes/delete?' + serialize_bulk;
          // }
        });

      return false;
    });
  }); /*end doc ready*/


  var tableToExcel = (function() {
          var uri = 'data:application/vnd.ms-excel;base64,'
            , template = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><meta http-equiv="content-type" content="application/vnd.ms-excel; charset=UTF-8"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>'
            , base64 = function(s) { return window.btoa(unescape(encodeURIComponent(s))) }
            , format = function(s, c) { return s.replace(/{(\w+)}/g, function(m, p) { return c[p]; }) }
          return function(table, name) {
            if (!table.nodeType) table = document.getElementById(table)
            var ctx = {worksheet: name || 'Worksheet', table: table.innerHTML}
            window.location.href = uri + base64(format(template, ctx))
          }
        })()

</script>