<script src="<?= BASE_ASSET; ?>/js/jquery.hotkeys.js"></script>
<script type="text/javascript">
   //This page is a result of an autogenerated content made by running test.html with firefox.
   function domo() {

      // Binding keys
      $('*').bind('keydown', 'Ctrl+e', function assets() {
         $('#btn_edit').trigger('click');
         return false;
      });

      $('*').bind('keydown', 'Ctrl+x', function assets() {
         $('#btn_back').trigger('click');
         return false;
      });

   }


   jQuery(document).ready(domo);
</script>
<!-- Content Header (Page header) -->
<section class="content-header">
   <h1> <?= $boutique['NAME_STORE']; ?> <i class="fa fa-chevron-right"></i> Articles<small></small></h1>
   <ol class="breadcrumb">
      <li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
      <li class=""><a href="<?= site_url('administrator/articles'); ?>">Articles</a></li>
      <li class="active"><?= cclang('detail'); ?></li>
   </ol>
</section>
<!-- Main content -->
<section class="content">
   <div class="row">

      <div class="col-md-12">
         <div class="box box-warning">
            <div class="box-body ">

               <!-- Widget: user widget style 1 -->
               <div class="box box-widget widget-user-2">
                  <!-- Add the bg color to the header using any of the bg-* classes -->


                  <form class="form-horizontal" name="form_hospital_ibi_articles" id="form_hospital_ibi_articles" action="<?= base_url('articles/'. $this->uri->segment(2) .'/approvisionnement/'. $this->uri->segment(4) . ''); ?>">

                     <div class="widget-user-header ">
                        <div class="row pull-center">
                           <div class="col-md-12">
                              <div class="col-lg-4 col-md-4 col-sm-4">
                                 <div class="input-group">
                                    <span class="input-group-addon">Date de départ</span>
                                    <input type="date" class="form-control" name="date_depart" value="<?= $date_depart ?>">
                                 </div>
                              </div>
                              <div class="col-lg-4 col-md-4 col-sm-4">
                                 <div class="input-group">
                                    <span class="input-group-addon">Date de fin</span>
                                    <input type="date" class="form-control" name="date_fin" value="<?= $date_fin ?>">
                                 </div>
                              </div>
                              <div class="col-lg-4 col-md-4 col-sm-4">
                                 <div class="btn-group btn-group-md">
                                    <button type="submit" name="name" class="btn btn-default"><i class="fa fa-refresh"></i>
                                    </button>
                                    <button type="button" print-item=".content-wrapper" name="name" class="btn btn-default" onclick="printTable()">
                                       <i class="fa fa-print"></i>
                                    </button>
                                    <button type="button" name="name" class="btn btn-default" onclick="tableToExcel('headerTable', 'W3C Example Table')">
                                       <i class="export glyphicon glyphicon-export"></i>
                                    </button>
                                 </div>
                              </div>
                              <!--   <div class="col-lg-4 col-md-4 col-sm-4">
                              <button type="submit" class="btn btn-default btn-flat"  id="">

                        <i class="fa fa-search"></i>

                        </button>
                                <div class="btn-group btn-group-md">
                                    <a class="btn btn-default btn-flat" name="reset" id="reset" value="Apply" href="<?= base_url('administrator/articles/approvisionnement/' . $this->uri->segment(4) . '/' . $this->uri->segment(5) . ''); ?>" title="<?= cclang('reset_filter'); ?>">

                        <i class="fa fa-undo"></i>

                        </a>
                                    <button type="button" print-item=".content-wrapper" name="name" class="btn btn-default" onclick="printTable()">
                                        <i class="fa fa-print"></i>Imprimer
                                    </button>
                                    <button type="button" name="name" class="btn btn-default" onclick="tableToExcel('headerTable', 'W3C Example Table')">
                                        <i class="fa fa-file"></i>Exporter XLS
                                    </button>
                                </div>
                              </div> -->
                           </div>
                        </div>

                     </div>
                  </form>
                  <div class="table-responsive">

                     <div class="box">
                        <div class="box-header with-border">Historique d'activité sur le produit</div>
                        <div class="box-body no-padding">
                           <table class="table  table-striped" id="headerTable">
                              <thead>
                                 <tr>
                                    <td>No</td>
                                    <td>Nom du produit</td>
                                    <td>Type</td>
                                    <td></td>
                                    <td>Quantité</td>
                                    <td>Prix</td>
                                    <td>Total</td>
                                    <td>Par</td>
                                    <td>Effectué</td>
                                 </tr>
                              </thead>
                              <tbody>
                                 <?php
                                 $i = 0;
                                 foreach ($articles as $article) :
                                    $i++;
                                    $author = $this->model_r_proforma->getOne('aauth_users', array('id' => $article->AUTHOR));
                                    $type_sf = '';
                                    if ($article->TYPE_SF == 'stock_out') {
                                       $type_sf = 'Sortie';
                                    }
                                    if ($article->TYPE_SF == 'stock_in') {
                                       $type_sf = 'Approvisionnement';
                                    }
                                    if ($article->TYPE_SF == 'stock_return') {
                                       $type_sf = 'Retour en stock';
                                    }
                                    if ($article->TYPE_SF == 'suppression') {
                                       $type_sf = 'Suppression';
                                    }
                                    if ($article->TYPE_SF == 'deffectueux') {
                                       $type_sf = 'Deffectueux';
                                    }
                                    if ($article->TYPE_SF == 'additionner') {
                                       $type_sf = 'Addition';
                                    }
                                 ?>
                                    <tr>
                                       <td><?php echo $i; ?></td>
                                       <td><?= _ent($article->DESIGN_ARTICLE); ?></td>
                                       <td><?= $type_sf ?></td>
                                       <td></td>
                                       <td><?= _ent($article->QUANTITE); ?></td>
                                       <td><?= _ent($article->UNIT_PRICE_SF); ?></td>
                                       <td><?= _ent($article->TOTAL_PRICE_SF); ?></td>
                                       <td><?= $author['username'] ?></td>
                                       <td><?= _ent($article->DATE_SF); ?></td>
                                    </tr>
                                 <?php endforeach; ?>
                                 <?php if ($articles_counts == 0) : ?>
                                    <tr>
                                       <td colspan="100">
                                          Les données sur la liste article ne sont pas disponibles
                                       </td>
                                    </tr>
                                 <?php endif; ?>
                              </tbody>

                           </table>
                        </div>
                     </div>

                  </div>

               </div>
            </div>
            <!--/box body -->
         </div>
         <!--/box -->
      </div>
   </div>
</section>
<!-- /.content -->
<script type="text/javascript">
   var tableToExcel = (function() {
      var uri = 'data:application/vnd.ms-excel;base64,',
         template = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><meta http-equiv="content-type" content="application/vnd.ms-excel; charset=UTF-8"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>',
         base64 = function(s) {
            return window.btoa(unescape(encodeURIComponent(s)))
         },
         format = function(s, c) {
            return s.replace(/{(\w+)}/g, function(m, p) {
               return c[p];
            })
         }
      return function(table, name) {
         if (!table.nodeType) table = document.getElementById(table)
         var ctx = {
            worksheet: name || 'Worksheet',
            table: table.innerHTML
         }
         window.location.href = uri + base64(format(template, ctx))
      }
   })()

   function printTable() {
      var divToPrint = document.getElementById("headerTable");
      newWin = window.open("");
      newWin.document.write(divToPrint.outerHTML);
      newWin.print();
      newWin.close();
   }
</script>